<!doctype html>
<html>

<head>
  <title>v-grid Code Examples. Columns</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="../demo.css">
  <script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="common.html">
  <script src="demodata.js"></script>
</head>

<body>

  <section>
    <h1><a href="./">v-grid</a>
      <span>Selection</span>
    </h1>
    <table-of-contents select="h3" class="toc"></table-of-contents>
  </section>

  <section>
    <h3>Selecting rows</h3>
    <p>Data rows can be selected either trough UI
      interaction (by clicking or tapping) or alternatively by using the
      selection JavaScript API.</p>
    <code-example>
      <v-grid demo>
        <table>
          <colgroup>
            <col header-text="Name">
            <col header-text="Value">
            <col header-text="Progress">
          </colgroup>
          <tbody>
            <tr>
              <td>Project A</td>
              <td>123</td>
              <td>0.8</td>
            </tr>
            <tr>
              <td>Project B</td>
              <td>456</td>
              <td>0.9</td>
            </tr>
          </tbody>
        </table>
      </v-grid>

      <code demo-var="grid1">
        grid1.selection.deselect(0);
        grid1.selection.select(1);
      </code>
    </code-example>
  </section>

  <section>
    <h3>Selection modes</h3>
    <p>
      <ul>
        <li><b>Single</b> is the default selection mode for Grid. It allows only one row to be selected at once.</li>
        <li><b>Multi</b> selection mode reveals an additional checkbox column allowing the user to select multiple rows.</li>
        <li><b>All</b> selection mode has each row selected by default allowing the user to deselect individual rows.</li>
        <li><b>Disabled</b> disables the selection functionality.</li>
      </ul>
    </p>
    <p>
      You can toggle between <b>multi</b> and <b>all</b> modes by clicking the checkbox on Grid header.
    </p>
    <code-example>
      <div demo>
        <v-grid selection-mode="multi">
          <table>
            <colgroup>
              <col header-text="Name">
              <col header-text="Surname">
              <col header-text="Activity">
            </colgroup>
          </table>
        </v-grid>
        Selection mode:
        <select>
          <option value="single">Single</option>
          <option value="multi" selected>Multi</option>
          <option value="all">All</option>
          <option value="disabled">Disabled</option>
        </select>
      </div>
      <code demo-var="demo2">
        // Set a datasource for the Grid
        var grid2 = demo2.querySelector("v-grid");
        grid2.data.source = myBigData;

        // Bind the mode select value to vgrid.selection.mode
        var modeSelect = demo2.querySelector("select")
        modeSelect.addEventListener("change", function() {
          grid2.selection.mode = modeSelect.value;
        });
        grid2.addEventListener("select", function() {
          modeSelect.value = grid2.selection.mode;
        });
      </code>
    </code-example>
  </section>

  <section>
    <h3>Processing the selections as arrays</h3>
    <p>You can simply ask the Grid for all the selected row indexes with <b>grid.selection.selected()</b>
      function which returns an array of integers for you to process further.</p>
    <p>This works fine on most cases with <i>single</i> and <i>multi</i> selection modes, but if your grid contains tons
      of data and the selection mode is set to <i>all</i>, you're better off with a likely more
      compact array attained from <b>grid.selection.deselected()</b>.</p>
    <code-example>
      <v-grid demo selection-mode="multi">
        <table>
          <colgroup>
            <col header-text="Name">
            <col header-text="Surname">
            <col header-text="Activity">
          </colgroup>
        </table>
      </v-grid>
      <code demo-var="grid3">
        // Set a datasource for the Grid
        grid3.data.source = myBigData;
        // Log the selections / deselection to console on select event
        grid3.addEventListener("select", function() {
          console.log("Selected: " + grid3.selection.selected());
          console.log("Deselected: " + grid3.selection.deselected());
        });
      </code>
    </code-example>
  </section>

  <section>
    <h3>Iterating the selections</h3>
    <p>Another option for processing the selections is to iterate trough them.
    The <b>grid.selection.selected()</b> and <b>grid.selection.deselected()</b> functions accept an iterator function
    as the first argument so you can loop trough all the selections without ever populating an array.</p>
    <p>If however your iterator function returns a value, then it's considered a mapper function meaning that
    the selection API function will return an array of pre-mapped values.</p>
    <code-example>
      <v-grid demo selection-mode="multi">
        <table>
          <colgroup>
            <col header-text="Name">
            <col header-text="Surname">
            <col header-text="Activity">
          </colgroup>
        </table>
      </v-grid>
      <code demo-var="grid4">
        // Set a datasource for the Grid
        grid4.data.source = myBigData;
        // Log selected designers list on select event
        grid4.addEventListener("select", function() {
          console.log("Selected designers:");
          grid4.selection.selected(function(index) {
            var data = myBigData[index];
            if (data[2] === "Design") {
              console.log("-" + data[0] + " " + data[1]);
            }
          });
        });

      </code>
    </code-example>
  </section>

  <section>
    <h3>Processing selections in batches</h3>
    <p>The <b>grid.selection.selected()</b> and <b>grid.selection.deselected()</b> functions also accept
    startIndex as the second argument and endIndex as the third argument. These can be used to process
    the selections in batches. <b>grid.selection.size</b> property comes in handy here.</p>
    <p>All the three parameters (iterator/mapper, startIndex, endIndex) have default values so any of
    them can be omitted (or set as undefined).</p>
    <code-example>
      <v-grid demo selection-mode="multi">
        <table>
          <colgroup>
            <col header-text="Name">
            <col header-text="Surname">
            <col header-text="Activity">
          </colgroup>
        </table>
      </v-grid>
      <code demo-var="grid5">
        // Set a datasource for the Grid
        grid5.data.source = myBigData;

        // Log selected indexes in batches of 5
        grid5.addEventListener("select", function() {
          for (var i = 0; i < grid5.selection.size; i += 5){
            console.log(grid5.selection.selected(undefined, i, i+4));
          }
        });
      </code>
    </code-example>
  </section>
</body>

</html>
